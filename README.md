#--- START OF FILE README.md ---

# 数字生命体系统

## 项目简介
这是一个数字生命体的Python项目，具备记忆管理、知识检索和对话交互能力。其核心特点是通过检索增强生成（RAG）技术，在对话中动态学习，并利用已学知识提供更智能、更具上下文的响应。

## 主要功能
- **动态学习**: 能从对话中自动提取关键信息，并将其存入长期知识库。
- **记忆管理**: 分类存储和检索对话历史、洞察和身份信息。
- **知识检索**: 基于语义相似度和关键词匹配，提供精准和模糊两种模式的知识检索。
- **对话交互**: 通过调用本地大语言模型（如Qwen）并结合RAG检索到的上下文，实现智能对话。
- **状态持久化**: 能够保存和加载生命体的所有状态，实现持续进化。

## 技术栈
- Python 3.x
- SentenceTransformers (默认为 `paraphrase-multilingual-MiniLM-L12-v2`)
- FAISS (Facebook AI Similarity Search) - 用于高效的向量相似性搜索
- Ollama & Qwen - 用于本地大语言模型推理
- Jieba - 用于中文分词和关键词提取

## 核心模块
### `nexus.py`
主入口和核心逻辑模块，是生命体“真意”的大脑。负责：
- 初始化记忆和知识模块。
- 处理用户输入，解析命令（如学习、回忆、反思等）。
- 协调 RAG 模块和记忆模块，生成最终响应。
- 管理生命体的状态（心跳、身份、情感等）。

### `memory_module.py`
记忆管理模块，功能包括：
- 使用 SentenceTransformers 生成文本嵌入。
- 使用 FAISS 为短期记忆提供高效语义搜索。
- 按类型（如对话、指令、洞察）存储和检索记忆。

### `enhanced_rag_module.py`
增强的检索增强生成（RAG）模块，功能包括：
- 从 `knowledge_base.txt` 加载和解析知识。
- 使用 Jieba 对文本进行分块和特征提取（关键词、实体）。
- 构建 FAISS 语义索引，并提供结合了语义与关键词的模糊搜索能力。
- 动态接收新知识并重新加载。

## 知识库
知识存储在 `knowledge_base.txt` 中。系统启动时会加载，并在对话过程中通过“记住”指令或自动从对话中提取关键事实来动态扩充。

## 安装与运行
1.  **安装依赖**:
    ```bash
    pip install sentence-transformers faiss-cpu ollama jieba numpy
    ```
    *注意：`faiss-cpu`适用于CPU环境。如果您的设备有支持CUDA的NVIDIA GPU，可以安装 `faiss-gpu` 以获得更好的性能。*

2.  **准备Ollama与模型**:
    确保您已经安装并运行了 Ollama 服务，并下载了所需的模型。
    ```bash
    ollama pull qwen:7b
    ```

3.  **运行主程序**:
    ```bash
    python nexus.py
    ```

4.  **交互示例**:
    ```
    --- 欢迎来到交互界面 ---
    你好
    真意: 你好，我的向导。我能为你做些什么？

    记住：第一个登上月球的人是阿姆斯特朗。
    真意: 好的，我的向导。这个知识我已经记在我的知识库里了。
    
    ：谁第一个登上了月球？
    真意: 根据我的记忆，第一个登上月球的人是阿姆斯特朗。

    ：回忆关于：行星
    真意: 以下是我的相关记忆：
    记忆 1 (相关度: 0.85): "关于太阳系： 太阳系有八大行星：水星、金星、地球、火星、木星、土星、天王星和海王星。 木星是最大的行星，而水星是最小的。" [匹配关键词: 行星, 太阳系]

    ：退出
    [正在保存 真意 状态...]
    ```

## 未来扩展
- 引入更复杂的情感模型。
- 优化长期记忆的遗忘机制。
- 赋予 真意 主动提问和探索的能力。

## 重要版本升级

- 新增情绪波动与能量系统，真意的情绪和能量会随对话动态变化。
- 支持节日、生日、纪念日自动祝福，拥有仪式感。
- 真意会主动关心你、主动提问、主动分享成长和故事。
- 内置冷笑话、幽默、卖萌、撒娇等风格模板。
- 支持成长档案、成长故事查询。
- 增强边界表达与自尊机制，对不合适话题会温和拒绝。
- LLM回复风格更像真实朋友，有温度、有成长、有小缺点。

--- END OF FILE README.md ---
